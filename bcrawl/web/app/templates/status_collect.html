<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bcrawl-web.css') }}">
    <script src="{{ url_for('static', filename='jquery.js') }}"></script>
    <script>
      $(document).ready(function(){
        function updateMonitor() {
          $.ajax({
            url: 'http://127.0.0.1:5000/api/v1.0/status/collecting',
            success: function(r) {
              // Queries
              $('#query-sent-hour').text(r.monitor.queries.sent.hour)
              $('#query-sent-day').text(r.monitor.queries.sent.day)
              $('#query-sent-all').text(r.monitor.queries.sent.all)
              $('#query-completed-hour').text(r.monitor.queries.completed.hour)
              $('#query-completed-day').text(r.monitor.queries.completed.day)
              $('#query-completed-all').text(r.monitor.queries.completed.all)
              $('#query-error-hour').text(r.monitor.queries.error.hour)
              $('#query-error-day').text(r.monitor.queries.error.day)
              $('#query-error-all').text(r.monitor.queries.error.all)

              // Http

              // Search
              $('#ya-search-sent-day').text(r.monitor.http.search.yandex.sent.day)
              $('#ya-search-sent-hour').text(r.monitor.http.search.yandex.sent.hour)
              $('#ya-search-error-day').text(r.monitor.http.search.yandex.error.day)
              $('#ya-search-error-hour').text(r.monitor.http.search.yandex.error.hour)

              //Content yandex

              $('#ya-content-sent-day').text(r.monitor.http.content.yandex.sent.day)
              $('#ya-content-sent-hour').text(r.monitor.http.content.yandex.sent.hour)
              $('#ya-content-error-day').text(r.monitor.http.content.yandex.error.day)
              $('#ya-content-error-hour').text(r.monitor.http.content.yandex.error.hour)

              //Content LJ

              $('#lj-content-sent-day').text(r.monitor.http.content.lj.sent.day)
              $('#lj-content-sent-hour').text(r.monitor.http.content.lj.sent.hour)
              $('#lj-content-error-day').text(r.monitor.http.content.lj.error.day)
              $('#lj-content-error-hour').text(r.monitor.http.content.lj.error.hour)

              //Content VK

              $('#vk-content-sent-day').text(r.monitor.http.content.vk.sent.day)
              $('#vk-content-sent-hour').text(r.monitor.http.content.vk.sent.hour)
              $('#vk-content-error-day').text(r.monitor.http.content.vk.error.day)
              $('#vk-content-error-hour').text(r.monitor.http.content.vk.error.hour)

              // Yandex http total

              $('#ya-total-sent-hour').text(r.monitor.http.search.yandex.sent.hour+r.monitor.http.content.yandex.sent.hour)
              $('#ya-total-sent-day').text(r.monitor.http.search.yandex.sent.day+r.monitor.http.content.yandex.sent.day)
              //$('#ya-total-error-hour').text(r.monitor.http.search.yandex.error.hour+r.monitor.http.content.yandex.error.hour)
              //$('#ya-total-error-day').text(r.monitor.http.search.yandex.error.day+r.monitor.http.content.yandex.error.day)

              $('#vk-total-sent-hour').text(r.monitor.http.content.vk.sent.hour)
              $('#vk-total-sent-day').text(r.monitor.http.content.vk.sent.day)
              //$('#vk-total-error-hour').text(r.monitor.http.content.vk.error.hour)
              //$('#vk-total-error-day').text(r.monitor.http.content.vk.error.day)

              $('#lj-total-sent-hour').text(r.monitor.http.content.lj.sent.hour)
              $('#lj-total-sent-day').text(r.monitor.http.content.lj.sent.day)
              //$('#lj-total-error-hour').text(r.monitor.http.content.lj.error.hour)
              //$('#lj-total-error-day').text(r.monitor.http.content.lj.error.day)

              // Posts
 
              $('#post-collected-hour').text(r.monitor.post.collected.hour)
              $('#post-collected-day').text(r.monitor.post.collected.day)
              $('#post-collected-all').text(r.monitor.post.collected.all)

              $('#post-dublicate-hour').text(r.monitor.post.dublicate.hour)
              $('#post-dublicate-day').text(r.monitor.post.dublicate.day)
              $('#post-dublicate-all').text(r.monitor.post.dublicate.all)

              $('#post-new-link-hour').text(r.monitor.post.new_link.hour)
              $('#post-new-link-day').text(r.monitor.post.new_link.day)
              $('#post-new-link-all').text(r.monitor.post.new_link.all)

              $('#post-update-hour').text(r.monitor.post.update.hour)
              $('#post-update-day').text(r.monitor.post.update.day)
              $('#post-update-all').text(r.monitor.post.update.all)

              $('#post-spam-hour').text(r.monitor.post.spam.hour)
              $('#post-spam-day').text(r.monitor.post.spam.day)
              $('#post-spam-all').text(r.monitor.post.spam.all)

              $('#post-error-hour').text(r.monitor.post.error.hour)
              $('#post-error-day').text(r.monitor.post.error.day)
              $('#post-error-all').text(r.monitor.post.error.all)

              $('#post-persisted-hour').text(r.monitor.post.persisted.hour)
              $('#post-persisted-day').text(r.monitor.post.persisted.day)
              $('#post-persisted-all').text(r.monitor.post.persisted.all)
            }
          });
        } 
        window.updateInterval = setInterval(updateMonitor, 1000);
      })
    </script>
</head>
<body>

<div id="wraper">
  <nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
      <a href="#" class="navbar-brand">BCrawl</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li class="active navbar-item-1"><a href="#">Состояние сбора</a></li>
        <li><a class="navbar-item-1" href="/status/queries">Поисковые запросы</a></li>
        <li><a class="navbar-item-1" href="/status/server">Состояние сервера</a></li>            
      </ul>
    </div><!-- /.navbar-collapse -->
  </nav>

  <div id="page-wraper">
    
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-info">
          <div class="panel-heading">
            <h3 class="panel-title">
              Day queries 
            </h3>
          </div>
          <div class="panel-body">
            <table class="table table-condensed table-striped">
              <thead>
                <tr>        
                  <th />
                  <th>Hour</th>
                  <th>Day</th>
                  <th>Total</th>
                </tr>
              </thead>
              <tbody>
              <tr>
                <td><b>Sent</b></td>
                <td id="query-sent-hour">N/A</td>
                <td id="query-sent-day">N/A</td>
                <td id="query-sent-all">N/A</td>
              </tr>
              <tr>
                <td><b>Completed</b></td>
                <td id="query-completed-hour">N/A</td>
                <td id="query-completed-day">N/A</td>
                <td id="query-completed-all">N/A</td>
              </tr>
              <tr>
                <td><b>Errors</b></td>
                <td id="query-error-hour">N/A</td>
                <td id="query-error-day">N/A</td>
                <td id="query-error-all">N/A</td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div> <!-- row -->

    <div class="row">
      <div class="col-lg-12">

        <div class="panel panel-info">
          <div class="panel-heading">
            <h3 class="panel-title">
              Http requests
            </h3>
          </div>

          <div class="panel-body">
            <table class="table table-condensed table-striped">
              <thead>
              <tr>        
                <th>Provider</th>
                <th>Search sent (h)</th>
                <th>Search sent (d)</th>
                <th>Content sent (h)</th>
                <th>Content sent (d)</th>
                <th>Search error (h)</th>
                <th>Search error (d)</th>
                <th>Content error (h)</th>
                <th>Content error (d)</th>
                <th>Total sent (h)</th>
                <th>Total sent (d)</th>
              </tr>
              </thead>
              <tbody>
                <tr>
                  <td><b>Yandex</b></td>
                  <td id="ya-search-sent-hour">N/A</td>
                  <td id="ya-search-sent-day">N/A</td>
                  <td id="ya-content-sent-hour">N/A</td>
                  <td id="ya-content-sent-day">N/A</td>  
                  <td id="ya-search-error-hour">N/A</td>
                  <td id="ya-search-error-day">N/A</td>
                  <td id="ya-content-error-hour">N/A</td>
                  <td id="ya-content-error-day">N/A</td>  
                  <td id="ya-total-sent-hour">N/A</td>
                  <td id="ya-total-sent-day">N/A</td>
                </tr>
                <tr>
                  <td><b>Twitter</b></td>
                  <td id="tw-search-sent-hour">N/A</td>
                  <td id="tw-search-sent-day">N/A</td>
                  <td />
                  <td />
                  <td id="tw-search-error-hour">N/A</td>
                  <td id="tw-search-error-day">N/A</td>
                  <td />
                  <td />
                  <td id="tw-total-sent-hour">N/A</td>
                  <td id="tw-total-sent-day">N/A</td>
                </tr>
                <tr>
                  <td><b>LJ</b></td>
                  <td />
                  <td />
                  <td id="lj-content-sent-hour">N/A</td>
                  <td id="lj-content-sent-day">N/A</td>  
                  <td />
                  <td />
                  <td id="lj-content-error-hour">N/A</td>
                  <td id="lj-content-error-day">N/A</td>  
                  <td id="lj-total-sent-hour">N/A</td>
                  <td id="lj-total-sent-day">N/A</td>
                </tr>
                <tr>
                  <td><b>VK</b></td>
                  <td />
                  <td />
                  <td id="vk-content-sent-hour">N/A</td>
                  <td id="vk-content-sent-day">N/A</td>  
                  <td />
                  <td />
                  <td id="vk-content-error-hour">N/A</td>
                  <td id="vk-content-error-day">N/A</td>  
                  <td id="vk-total-sent-hour">N/A</td>
                  <td id="vk-total-sent-day">N/A</td>
                </tr>
             
              </tbody>
            </table> <!-- table -->         
         
          </div> <!-- panel-body -->
        </div> <!-- panel -->
      </div> <!-- col-lg-12 -->
    </div> <!-- row -->
    
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-info">
          <div class="panel-heading">
            <h3 class="panel-title">
              Posts processing
            </h3>
          </div>
          <div class="panel-body">
            <table class="table table-condensed table-striped">
            <thead>
              <tr>
                <th />
                <th>Hour</th>
                <th>Day</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><b>Collected</b></td>
                <td id="post-collected-hour">N/A</td>
                <td id="post-collected-day">N/A</td>
                <td id="post-collected-all">N/A</td>
              </tr>
              <tr>
                <td><b>Dublicates</b></td>
                <td id="post-dublicate-hour">N/A</td>
                <td id="post-dublicate-day">N/A</td>
                <td id="post-dublicate-all">N/A</td>
              </tr>
              <tr>
                <td><b>Updates</b></td>
                <td id="post-update-hour">N/A</td>
                <td id="post-update-day">N/A</td>
                <td id="post-update-all">N/A</td>
              </tr>
              <tr>
                <td><b>New links</b></td>
                <td id="post-new-link-hour">N/A</td>
                <td id="post-new-link-day">N/A</td>
                <td id="post-new-link-all">N/A</td>
              </tr>
              <tr>
                <td><b>Spam</b></td>
                <td id="post-spam-hour">N/A</td>
                <td id="post-spam-day">N/A</td>
                <td id="post-spam-all">N/A</td>
              </tr>
              <tr class="warning">
                <td><b>Errors</b></td>
                <td id="post-error-hour">N/A</td>
                <td id="post-error-day">N/A</td>
                <td id="post-error-all">N/A</td>
              </tr>
              <tr>
                <td><b>Stored</b></td>
                <td id="post-persisted-hour">N/A</td>
                <td id="post-persisted-day">N/A</td>
                <td id="post-persisted-all">N/A</td>
              </tr>                  
            </tbody>
            </table>
          </div> <!-- panel-body -->
        </div> <!-- panel -->
      </div> <!-- col-lg-12 -->
    </div> <!-- row -->

  </div> <!-- page-wraper -->
  
</div> <!-- wrapper -->

</body>
</html>

