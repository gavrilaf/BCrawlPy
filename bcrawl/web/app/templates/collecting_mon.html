<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}">
    <script src="{{ url_for('static', filename='jquery.js') }}"></script>

    <script>
      $(document).ready(function(){
        function updateMonitor() {
          $.ajax({
            url: 'http://127.0.0.1:5000/api/v1.0/cmon',
            success: function(r) {
              $('#query-sent-hour').text(r.monitor.queries.sent.hour)
              $('#query-sent-day').text(r.monitor.queries.sent.day)
              $('#query-sent-all').text(r.monitor.queries.sent.all)
              $('#query-completed-hour').text(r.monitor.queries.completed.hour)
              $('#query-completed-day').text(r.monitor.queries.completed.day)
              $('#query-completed-all').text(r.monitor.queries.completed.all)

              $('#ya-search-sent-day').text(r.monitor.http.search.yandex.sent.day)
              $('#ya-search-sent-hour').text(r.monitor.http.search.yandex.sent.hour)
              $('#ya-search-error-day').text(r.monitor.http.search.yandex.error.day)
              $('#ya-search-error-hour').text(r.monitor.http.search.yandex.error.hour)

              $('#ya-content-sent-day').text(r.monitor.http.content.yandex.sent.day)
              $('#ya-content-sent-hour').text(r.monitor.http.content.yandex.sent.hour)
              $('#ya-content-error-day').text(r.monitor.http.content.yandex.error.day)
              $('#ya-content-error-hour').text(r.monitor.http.content.yandex.error.hour)

              $('#lj-content-sent-day').text(r.monitor.http.content.lj.sent.day)
              $('#lj-content-sent-hour').text(r.monitor.http.content.lj.sent.hour)
              $('#lj-content-error-day').text(r.monitor.http.content.lj.error.day)
              $('#lj-content-error-hour').text(r.monitor.http.content.lj.error.hour)

              $('#vk-content-sent-day').text(r.monitor.http.content.vk.sent.day)
              $('#vk-content-sent-hour').text(r.monitor.http.content.vk.sent.hour)
              $('#vk-content-error-day').text(r.monitor.http.content.vk.error.day)
              $('#vk-content-error-hour').text(r.monitor.http.content.vk.error.hour)

              $('#post-collected-hour').text(r.monitor.post.collected.hour)
              $('#post-collected-day').text(r.monitor.post.collected.day)
              $('#post-collected-all').text(r.monitor.post.collected.all)

              $('#post-dublicate-hour').text(r.monitor.post.dublicate.hour)
              $('#post-dublicate-day').text(r.monitor.post.dublicate.day)
              $('#post-dublicate-all').text(r.monitor.post.dublicate.all)

              $('#post-new-link-hour').text(r.monitor.post.new_link.hour)
              $('#post-new-link-day').text(r.monitor.post.new_link.day)
              $('#post-new-link-all').text(r.monitor.post.new_link.all)

              $('#post-update-hour').text(r.monitor.post.update.hour)
              $('#post-update-day').text(r.monitor.post.update.day)
              $('#post-update-all').text(r.monitor.post.update.all)

              $('#post-error-hour').text(r.monitor.post.error.hour)
              $('#post-error-day').text(r.monitor.post.error.day)
              $('#post-error-all').text(r.monitor.post.error.all)

              $('#post-persisted-hour').text(r.monitor.post.persisted.hour)
              $('#post-persisted-day').text(r.monitor.post.persisted.day)
              $('#post-persisted-all').text(r.monitor.post.persisted.all)
            }
          });
        } 
        window.updateInterval = setInterval(updateMonitor, 1000);
      })
    </script>
</head>
<body>
<div class="navbar">
    <div class="navbar-inner">
        <a class="brand" href="#">BCrawl monitor</a>
        <ul class="nav">
            <li class="active"><a href="#">Состояние сбора</a></li>
            <li><a href="/status/queries">Статус сбора</a></li>
            <li><a href="/status/server">Состояние сервера</a></li>
        </ul>
    </div>
</div>
<div class="container">

    <h3>Запросы для поиска</h3>
    <hr>

    <div class="row">
        <table class="table table-bordered table-condensed">
            <thead>
              <tr>        
                <th />
                <th>Час</th>
                <th>Сутки</th>
                <th>Всего</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Отправлено</td>
                <td id="query-sent-hour">N/A</td>
                <td id="query-sent-day">N/A</td>
                <td id="query-sent-all">N/A</td>
              </tr>
              <tr class="success">
                <td>Собрано</td>
                <td id="query-completed-hour">N/A</td>
                <td id="query-completed-day">N/A</td>
                <td id="query-completed-all">N/A</td>
              </tr>
              <tr class="error">
                <td>Ошибки</td>
                <td id="query-error-hour">N/A</td>
                <td id="query-error-days">N/A</td>
                <td id="query-error-all">N/A</td>
              </tr>
            </tbody>
        </table>
    </div>

    <h3>Http requests</h3>
    <hr>

    <div class="row">
        <h4>Поиск</h4>
        <div class="span6">
            <table class="table table-condensed table-bordered">
                <thead>
                    <tr>
                        <th>Yandex</th>
                        <th>Час</th>
                        <th>Сутки</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="success">
                        <td>Отправлено</td>
                        <td id="ya-search-sent-hour">N/A</td>
                        <td id="ya-search-sent-day">N/A</td>
                    </tr>
                    <tr class="error">
                        <td>Ошибки</td>
                        <td id="ya-search-error-hour">N/A</td>
                        <td id="ya-search-error-day">N/A</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="span6">
            <table class="table table-condensed table-bordered">
                <thead>
                    <tr>
                        <th>Twitter</th>
                        <th>Час</th>
                        <th>Сутки</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="success">
                        <td>Отправлено</td>
                        <td id="tw-search-sent-hour">N/A</td>
                        <td id="tw-search-sent-day">N/A</td>
                    </tr>
                    <tr class="error">
                        <td>Ошибки</td>
                        <td id="tw-search-error-hour">N/A</td>
                        <td id="tw-search-error-day">N/A</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <h4>Сбор контента</h4>
        <div class="span4">
            <table class="table table-striped table-bordered table-condensed bordered">
                <thead>
                    <tr>
                        <th>Yandex контент</th>
                        <th>Час</th>
                        <th>Сутки</th>                      
                    </tr>
                </thead>
                <tbody>
                    <tr class="success">
                        <td>Отправлено</td>
                        <td id="ya-content-sent-hour">N/A</td>
                        <td id="ya-content-sent-day">N/A</td>                      
                    </tr>
                    <tr class="error">
                        <td>Ошибки</td>
                        <td id="ya-content-error-hour">N/A</td>
                        <td id="ya-content-error-day">N/A</td>                      
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="span4">
            <table class="table table-striped table-bordered table-condensed bordered">
                <thead>
                    <tr>
                      <th>LJ контент</th>
                      <th>Час</th>
                      <th>Сутки</th>                      
                    </tr>
                </thead>
                <tbody>
                    <tr class="success">
                      <td>Отправлено</td>
                      <td id="lj-content-sent-hour">N/A</td>
                      <td id="lj-content-sent-day">N/A</td>                      
                    </tr>
                    <tr class="error">
                      <td>Ошибки</td>
                      <td id="lj-content-error-hour">N/A</td>
                      <td id="lj-content-error-day">N/A</td>                      
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="span4">
            <table class="table table-striped table-bordered table-condensed bordered">
              <thead>
                <tr>
                  <th>VK контент</th>
                  <th>Час</th>
                  <th>Сутки</th>
                </tr>
              </thead>
              <tbody>
                <tr class="success">
                  <td>Отправлено</td>
                  <td id="vk-content-sent-hour">N/A</td>
                  <td id="vk-content-sent-day">N/A</td>                      
                </tr>
                <tr class="error">
                  <td>Ошибки</td>
                  <td id="vk-content-error-hour">N/A</td>
                  <td id="vk-content-error-day">N/A</td>                      
                </tr>
              </tbody>
            </table>
        </div>
    </div>

    <h3>Обработка постов</h3>
    <hr>

    <div class="row">
        <table class="table table-striped table-bordered table-condensed">
            <thead>
              <tr>
                <th />
                <th>Час</th>
                <th>Сутки</th>
                <th>Всего</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Собрано</td>
                <td id="post-collected-hour">N/A</td>
                <td id="post-collected-day">N/A</td>
                <td id="post-collected-all">N/A</td>
              </tr>
              <tr>
                <td>Дубликаты</td>
                <td id="post-dublicate-hour">N/A</td>
                <td id="post-dublicate-day">N/A</td>
                <td id="post-dublicate-all">N/A</td>
              </tr>
              <tr>
                <td>Обновления</td>
                <td id="post-update-hour">N/A</td>
                <td id="post-update-day">N/A</td>
                <td id="post-update-all">N/A</td>
              </tr>
              <tr>
                <td>Новый запрос</td>
                <td id="post-new-link-hour">N/A</td>
                <td id="post-new-link-day">N/A</td>
                <td id="post-new-link-all">N/A</td>
              </tr>
              <tr>
                <td>Спам</td>
                <td id="post-spam-hour">N/A</td>
                <td id="post-spam-day">N/A</td>
                <td id="post-spam-all">N/A</td>
              </tr>
              <tr class="error">
                <td>Ошибки</td>
                <td id="post-error-hour">N/A</td>
                <td id="post-error-day">N/A</td>
                <td id="post-error-all">N/A</td>
              </tr>
              <tr class="success">
                <td>Сохранено</td>
                <td id="post-persisted-hour">N/A</td>
                <td id="post-persisted-day">N/A</td>
                <td id="post-persisted-all">N/A</td>
              </tr>                  
            </tbody>
        </table>
    </div>
   

</div>


</body>
</html>

