<!DOCTYPE HTML>
<html lang="en">
  
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap-responsive.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='common.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='monitor.css') }}">

    <script src="{{ url_for('static', filename='jquery.js') }}"></script>
    <script>
      $(document).ready(function(){
        function updateRest() {
          $.ajax({
            url: 'http://127.0.0.1:5000/api/v1.0/monitor',
            success: function(r) {
              $('#ya_search').text(r.monitor.yandex_search)
              $('#ya_content').text(r.monitor.yandex_content)
              $('#lj_content').text(r.monitor.lj_content)
              $('#vk_content').text(r.monitor.vk_content)
              $('#posts_found').text(r.monitor.posts_found)
              $('#dublicate_found').text(r.monitor.dublicates)
              $('#posts_persisted').text(r.monitor.persisted)
            }
          });
        } 
        window.restUpdateInterval = setInterval(updateRest, 1000);
      })
    </script>
    <title>Monitor</title>
  </head>
  
  <body>
    <div id="page-wrapper">
      <div id="absolute-wrapper">
        <div class="div-1 div-2 div-4">
          <div class="page-header div-1">
            <h1>BlCrawl Monitor <small></small>
            </h1>
          </div>
          <h3 class="heading">Http requests</h3>
        </div>
        <div class="div-2 div-3 div-5">
          <table class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Provider</th>
                <th>Search</th>
                <th>Content</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Yandex</strong> 
                </td>
                <td id="ya_search">{{monitor.yandex_search}}</td>
                <td id="ya_content">{{monitor.yandex_content}}</td>
              </tr>
              <tr>
                <td><strong>LJ</strong> 
                </td>
                <td></td>
                <td id="lj_content">{{monitor.lj_content}}</td>
              </tr>
              <tr>
                <td> <strong>VK</strong>
                </td>
                <td></td>
                <td id="vk_content">{{monitor.vk_content}}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="div-2 div-3 div-6">
          <h3 class="heading">Post processing</h3>
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Found</th>
                <th>Dublicate</th>
                <th>Spam</th>
                <th>Persisted</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td id="posts_found">1000
                </td>
                <td id="dublicate_found">200</td>
                <td></td>
                <td id="posts_persisted">690</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </body>

</html>